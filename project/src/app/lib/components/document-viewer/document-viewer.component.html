<div class="document-viewer" [class.fullscreen]="fullScreen()">
  <div class="document-header">
    <div class="document-title">
      <i class="ph ph-files" aria-hidden="true"></i>
      <h1>Visualiseur de documents</h1>
      @if (personId() !== null && documents().length > 0) {
        <span class="document-counter">
          Document {{ currentDocumentIndex() + 1 }}/{{ documents().length }}
        </span>
      }
    </div>
    
    <div class="document-actions">
      <psh-button
        appearance="text"
        variant="primary"
        icon="arrows-out"
        iconPosition="only"
        (clicked)="toggleFullScreen()"
        ariaLabel="Plein écran"
      ></psh-button>
      
      <psh-button
        appearance="text"
        variant="primary"
        icon="x"
        iconPosition="only"
        (clicked)="closeViewer()"
        ariaLabel="Fermer la visionneuse"
      ></psh-button>
    </div>
  </div>

  <div class="document-body">
    <div class="document-navigation">
      <psh-button
        appearance="outline"
        variant="primary"
        icon="caret-left"
        (clicked)="goToPreviousDocument()"
        [disabled]="!hasPrevious()"
      >
        Précédent
      </psh-button>

      <div class="document-info">
        @if (currentDocument()) {
          <h2>{{ currentDocument()?.name }}</h2>
          <p class="document-date">
            <i class="ph ph-calendar" aria-hidden="true"></i>
            {{ formatDate(currentDocument()?.date) }}
          </p>
          @if (currentDocument()?.type) {
            <p class="document-type">
              <i class="ph ph-file-text" aria-hidden="true"></i>
              {{ currentDocument()?.type }}
            </p>
          }
        } @else {
          <h2>Aucun document sélectionné</h2>
        }
      </div>

      <psh-button
        appearance="outline"
        variant="primary"
        icon="caret-right"
        (clicked)="goToNextDocument()"
        [disabled]="!hasNext()"
      >
        Suivant
      </psh-button>
    </div>

    <div class="document-content">
      @if (currentDocument()) {
        <iframe 
          [src]="safeUrl()" 
          frameborder="0" 
          width="100%" 
          height="100%"
          title="Document viewer"
          sandbox="allow-same-origin allow-scripts"
          aria-label="Document viewer"
        ></iframe>
      } @else {
        <div class="no-documents">
          <div class="empty-state">
            <i class="ph ph-file-x" aria-hidden="true"></i>
            <p>Aucun document disponible pour ce client</p>
          </div>
        </div>
      }
    </div>
  </div>
</div>
